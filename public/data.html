<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visitor's Log</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <!-- <h1>Enter email to remove</h1>
    <form action="/data_page2" method="POST">
        <input type="text" id="name" name="name"><br>
        <input type="submit" value="Submit">
    </form> -->

    
    <section id="logs">

        <div class="navbar container">
            <h2>Visitor's Log</h2>
            <p>Visitors Inside : <h3 class="count">0</h3></p>

            <a href="/">
                <div class="nav-button">
                    <h4>New Entry</h4>
                    <h4>&#43;</h4>
                </div>
            </a>
        </div>

        <div id="logTable" class="table container container-white">
            <div class="row heading-row">
                <div class="sno">Sr. No.</div>
                <div class="agency">Agency</div>
                <div class="t-in">In Time</div>
                <div class="t-size">Team Size</div>
                <div class="w-area">Area of Work</div>
                <div class="w-type">Type of Work</div>
                <div class="c-out"> Check Out</div>
            </div>
            <!-- <div class="row">
                <div class="sno">1</div>
                <div class="agency">Engineers</div>
                <div class="t-in">16:45 Hrs</div>
                <div class="t-size">3</div>
                <div class="w-area">Compartment 1</div>
                <div class="w-type">Regular Inspection</div>
                <div class="c-out"> Check Out</div>
            </div> -->
        </div>
    </section>

    <script>
        fetch('data.json').then(res => {
        return res.json();
        }).then(data => {
        console.table(data);

        const table = document.getElementById('logTable');
        let sr = 0;
        let visitors = 0;
        data.forEach(element => {
            visitors+=parseInt(element.size);
            table.innerHTML = table.innerHTML + `<div class="row">
                <div class="sno align_center">${++sr}</div>
                <div class="agency align_center">${element.agency}</div>
                <div class="t-in align_center">${element.name}</div>
                <div class="t-size align_center">${element.size}</div>
                <div class="w-area align_center">${element.area}</div>
                <div class="w-type align_center">${element.work}</div>
                <div class="c-out"> 
                    <form action="/data_remove" class="entryForm" method="post">
                    <input type="hidden" name="agency" value="${element.agency}" />
                    <input type="hidden" name="area" value="${element.area}" />
                    <input class="sub" type="submit" value="X">
                    </form>
                </div>
            </div>`
        });
        // console.log(document.querySelector('.count'));
        // console.log(visitors);
        document.querySelector('.count').innerText = visitors;
    
        }).catch(err => {
            alert("Error Loading Visitor Data")
        });

        document.querySelectorAll('row').length()

    </script>
</body>
</html>